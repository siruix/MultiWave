function z = circular_conv(x, y)
    N = length(x)+length(y)-1; % zero padding to length N
    xpad = [x zeros(1,N-length(x))];
    ypad = [y zeros(1,N-length(y))];
    z = zeros(1, N);
    for k=0:(N-1)
        for n = 0:(N-1)
          z(k+1) = z(k+1) + xpad(n+1) * ypad(mod(k+1-n, N));
        end
    end
end